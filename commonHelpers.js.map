{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["// pixabay-api.js\n\nconst KEY = '42555164-0de9ae952fe9eb05e418ffbde';\n\nexport async function fetchImages(query, page = 1, perPage = 15) {\n  const url = `https://pixabay.com/api/?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await fetch(url);\n\n    if (!response.ok) {\n      throw new Error('Network response was not ok');\n    }\n\n    const data = await response.json();\n    \n    if (data.hits.length === 0) {\n      throw new Error('No images found');\n    }\n\n    return { totalHits: data.totalHits, images: data.hits };\n  } catch (error) {\n    throw error;\n  }\n}\n","\nimport iziToast from 'izitoast';\nimport * as basicLightbox from 'basiclightbox'\n\nexport function renderCards(images, galleryElement) {\n  const gallery = document.querySelector(galleryElement);\n  gallery.innerHTML = '';\n\n  images.forEach((image) => {\n    const cardMarkup = createCardMarkup(image);\n    gallery.insertAdjacentHTML('beforeend', cardMarkup);\n  });\n}\n\nfunction createCardMarkup(image) {\n  return `\n    <div class=\"card\" data-large-image=\"${image.largeImageURL}\">\n      <a href=\"${image.largeImageURL}\">\n        <img src=\"${image.webformatURL}\" class=\"card-img\" alt=\"${image.tags}\">\n      </a>\n      <ul class=\"img-info\">\n        <li class=\"img-info-item\">Likes: ${image.likes}</li>\n        <li class=\"img-info-item\">Views: ${image.views}</li>\n        <li class=\"img-info-item\">Comments: ${image.comments}</li>\n        <li class=\"img-info-item\">Downloads: ${image.downloads}</li>\n      </ul>\n    </div>\n  `;\n}","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport { fetchImages } from './js/pixabay-api.js';\nimport { renderCards } from './js/render-functions.js';\n\nconst loader = document.querySelector('.loader');\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.search-input');\nconst gallery = '.gallery';\nconst loadMoreButton = document.querySelector('.load-more-btn');\nlet currentPage = 1;\nlet totalHits = 0;\nlet currentQuery = '';\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const query = input.value.trim();\n  loader.style.display = 'inline-block';\n\n  if (query.length < 3) {\n    iziToast.error({\n      message: 'Search query must be at least 3 characters long',\n      position: 'topRight',\n    });\n    loader.style.display = 'none';\n    return;\n  }\n\n  if (query === '') {\n    iziToast.show({\n      message: 'Please write what you want to search',\n      position: 'topRight',\n      color: 'red',\n    });\n    loader.style.display = 'none';\n    return;\n  }\n\n  try {\n    const result = await fetchImages(query);\n    const newTotalHits = result.totalHits;\n    currentQuery = query;\n    totalHits = newTotalHits;\n\n    renderCards(result.images, gallery);\n    gallery.innerHTML = '';\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    // Toggle load more button based on totalHits and currentPage\n    toggleLoadMoreButton(newTotalHits > currentPage * 15);\n\n    // Smooth scroll after rendering images\n    const cardHeight = getGalleryCardHeight();\n    window.scrollBy(0, cardHeight * 2); // Scroll by two card heights\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n    form.reset();\n  }\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  loader.style.display = 'inline-block';\n\n  try {\n    currentPage++;\n    const result = await fetchImages(currentQuery, currentPage);\n    renderCards(result.images, gallery);\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    // Toggle load more button based on totalHits and currentPage\n    toggleLoadMoreButton(totalHits > currentPage * 15);\n\n    // Smooth scroll after rendering images\n    const cardHeight = getGalleryCardHeight();\n    window.scrollBy(0, cardHeight * 2); // Scroll by two card heights\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n  }\n});\n\nfunction toggleLoadMoreButton(show) {\n  loadMoreButton.style.display = show ? 'block' : 'none';\n}\n\nfunction getGalleryCardHeight() {\n  // Get the height of one gallery card\n  const card = document.querySelector(`${gallery} a`);\n  const cardRect = card.getBoundingClientRect();\n  return cardRect.height;\n}\n"],"names":["KEY","fetchImages","query","page","perPage","url","response","data","error","renderCards","images","galleryElement","gallery","image","cardMarkup","createCardMarkup","loader","form","input","loadMoreButton","currentPage","totalHits","currentQuery","event","iziToast","result","newTotalHits","SimpleLightbox","toggleLoadMoreButton","cardHeight","getGalleryCardHeight","show"],"mappings":"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"}