{"version":3,"file":"commonHelpers.js","sources":["../src/js/render-functions.js","../src/main.js"],"sourcesContent":["export function renderCards(images, gallery) {\n\n  images.forEach((image, index) => {\n    const cardMarkup = createCardMarkup(image);\n    gallery.insertAdjacentHTML('beforeend', cardMarkup);\n\n    // Scroll to the last appended image\n    if (index === images.length - 1) {\n      const lastImage = gallery.lastElementChild;\n      lastImage.scrollIntoView({ behavior: 'smooth', block: 'end', inline: 'nearest' });\n    }\n  });\n}\n\nfunction createCardMarkup(image) {\n  return `\n    <div class=\"card\" data-large-image=\"${image.largeImageURL}\">\n      <a href=\"${image.largeImageURL}\">\n        <img src=\"${image.webformatURL}\" class=\"card-img\" alt=\"${image.tags}\">\n      </a>\n      <ul class=\"img-info\">\n        <li class=\"img-info-item\">Likes: ${image.likes}</li>\n        <li class=\"img-info-item\">Views: ${image.views}</li>\n        <li class=\"img-info-item\">Comments: ${image.comments}</li>\n        <li class=\"img-info-item\">Downloads: ${image.downloads}</li>\n      </ul>\n    </div>\n  `;\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\nimport { renderCards } from './js/render-functions.js';\n\nconst loader = document.querySelector('.loader');\nconst form = document.querySelector('.form');\nconst input = document.querySelector('.search-input');\nconst gallery = document.querySelector('.gallery');\nconst loadMoreButton = document.querySelector('.load-more-btn');\nlet currentPage = 1;\nlet totalHits = 0;\nlet totalPages = 0\nlet currentQuery = '';\nlet firstLoad = true;\n\nform.addEventListener('submit', async (event) => {\n  event.preventDefault();\n  const query = input.value.trim();\n  loader.style.display = 'inline-block';\n\n  if (!query || query.length < 3) {\n    iziToast.error({\n      message: 'Search query must be at least 3 characters long',\n      position: 'topRight',\n    });\n    loader.style.display = 'none';\n    return;\n  }\n\n  try {\n    const result = await fetchImages(query);\n    currentQuery = query;\n    totalHits = result.totalHits;\n\n    renderCards(result.images, gallery, firstLoad);\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    toggleLoadMoreButton(totalHits > currentPage * 15);\n    firstLoad = false;\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n    form.reset();\n  }\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  loader.style.display = 'inline-block';\n  currentPage++;\n\n  try {\n    const result = await fetchImages(currentQuery, currentPage);\n\n    renderCards(result.images, gallery, firstLoad);\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captionsData: 'alt',\n      captionDelay: 250,\n    });\n    lightbox.refresh();\n\n    toggleLoadMoreButton(totalHits > currentPage * 15);\n    firstLoad = false;\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n  }\n});\n\nfunction toggleLoadMoreButton(show) {\n  loadMoreButton.style.display = show && currentPage < totalPages ? 'block' : 'none';\n}\n\n\nasync function fetchImages(query, page = 1) {\n  const KEY = '42555164-0de9ae952fe9eb05e418ffbde';\n  const perPage = 15;\n\n  const url = `https://pixabay.com/api/?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&page=${page}&per_page=${perPage}`;\n\n  try {\n    const response = await axios.get(url);\n\n    if (response.data.hits.length === 0) {\n      // Notify user when no images found\n      iziToast.info({\n        message: 'No images found',\n        position: 'topRight',\n      });\n      \n      // Clear the gallery\n      gallery.innerHTML = '';\n      totalPages = 0; // Reset totalPages\n    } else {\n      totalPages = Math.ceil(response.data.totalHits / perPage); // Set totalPages\n    }\n\n    return {\n      images: response.data.hits,\n      totalHits: response.data.totalHits,\n      totalPages: totalPages,\n    };\n  } catch (error) {\n    console.error('Error during search:', error.message);\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred during the search',\n      position: 'topRight',\n    });\n    return {\n      images: [],\n      totalHits: 0,\n      totalPages: 0,\n    };\n  }\n}\n"],"names":["renderCards","images","gallery","image","index","cardMarkup","createCardMarkup","loader","form","input","loadMoreButton","currentPage","totalHits","totalPages","currentQuery","firstLoad","event","query","iziToast","result","fetchImages","SimpleLightbox","toggleLoadMoreButton","error","show","page","url","response","axios"],"mappings":"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"}